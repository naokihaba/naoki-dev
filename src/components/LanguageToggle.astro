---
import { css } from '../../styled-system/css';
import { languages, getLangFromUrl, getLocalizedPath } from '../i18n';

const currentUrl = Astro.url;
const currentLang = getLangFromUrl(currentUrl);
const currentPath = currentUrl.pathname.replace(/^\/(ja|en)/, '') || '/';

const toggleStyles = css({
  display: 'flex',
  alignItems: 'center',
  gap: '0.25rem',
  padding: '0.25rem',
  background: 'transparent',
  border: '1px solid',
  borderColor: 'border',
  borderRadius: '4px',
  fontSize: '0.75rem',
});

const linkStyles = css({
  padding: '0.25rem 0.5rem',
  textDecoration: 'none',
  color: 'textMuted',
  borderRadius: '2px',
  transition: 'all 0.2s ease',
  _hover: {
    color: 'text',
  },
});

const activeLinkStyles = css({
  padding: '0.25rem 0.5rem',
  textDecoration: 'none',
  color: 'text',
  bg: 'bgCode',
  borderRadius: '2px',
  fontWeight: 'bold',
});
---

<div class={toggleStyles}>
  {Object.entries(languages).map(([lang, label]) => (
    <a
      href={getLocalizedPath(currentPath, lang as keyof typeof languages)}
      class={currentLang === lang ? activeLinkStyles : linkStyles}
      aria-current={currentLang === lang ? 'page' : undefined}
    >
      {lang.toUpperCase()}
    </a>
  ))}
</div>
