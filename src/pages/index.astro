---
import { getCollection } from 'astro:content'
import BaseHead from '../components/BaseHead.astro'
import Footer from '../components/Footer.astro'
import FormattedDate from '../components/FormattedDate.astro'
import Header from '../components/Header.astro'
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts'
import { css } from '../../styled-system/css'

const posts = (await getCollection('blog', ({ data }) => data.published)).sort((a, b) => b.data.published_at.valueOf() - a.data.published_at.valueOf())
---

<!doctype html>
<html lang="ja">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <body class="home">
    <Header />
    <main class={css({ maxWidth: '1200px', margin: '0 auto', padding: { base: '1rem 0.75rem', md: '2rem 1rem' } })}>
      <ul
        class={css({
          listStyleType: 'none',
          margin: 0,
          padding: 0,
          display: 'flex',
          flexDirection: 'column',
          gap: { base: '0.75rem', md: '1rem' },
        })}
      >
        {
          posts.map((post) => (
            <li>
              <a
                href={`/blog/${post.id}/`}
                class={css({
                  display: 'flex',
                  alignItems: 'baseline',
                  gap: '1rem',
                  textDecoration: 'none',
                  padding: { base: '0.5rem 0', md: '0.75rem 0' },
                  borderBottom: '1px solid',
                  borderColor: 'border',
                  transition: 'color 0.2s ease',
                  _hover: {
                    color: 'accent',
                  },
                })}
              >
                <time
                  class={css({
                    flexShrink: 0,
                    color: 'textMuted',
                    fontSize: { base: '0.75rem', md: '0.875rem' },
                  })}
                >
                  <FormattedDate date={post.data.published_at} />
                </time>
                <span
                  class={css({
                    color: 'text',
                    fontSize: { base: '0.875rem', md: '1rem' },
                    fontWeight: 500,
                    lineHeight: 1.4,
                  })}
                >
                  {post.data.title}
                </span>
              </a>
            </li>
          ))
        }
      </ul>
    </main>
    <Footer />
  </body>
</html>
